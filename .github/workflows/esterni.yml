name: Esterni LaTeX document
on: 
  push:    
    paths:
      - 'esterni/**'
      - '.github/**'

jobs:
  build_latex:
    runs-on: ubuntu-latest
    steps:
      - name: Set up Git repository
        uses: actions/checkout@v2            
            
      - name: Compile "esterni" documents
        uses: xu-cheng/texlive-action/full@v1
        with:
          #Mi sposto nella cartella "interni/verbali" e mi prendo la lista delle sottocartelle
          #Successivamente compilo i main.tex di ogni sottocartella
          run: |
            cd esterni
            for d in */ ; do
                latexmk -pdf -file-line-error -halt-on-error -interaction=nonstopmode -cd ${d}main.tex
            done
            
            
      - name: Notify Discord if failure
        uses: sarisia/actions-status-discord@v1
        if: failure()
        with:
          webhook: ${{ secrets.BUILD_FAILURE_WEBHOOK }}
          title: "Latex Esterni"
          color: 0xff0000
          username: GitHub Actions
            
